package com.github.rtempleton.tysonsappoc;

import java.util.ArrayList;
import java.util.Map;

import org.junit.Ignore;
import org.junit.Test;

import com.github.rtempleton.poncho.test.AbstractTestCase;
import com.jayway.jsonpath.DocumentContext;
import com.jayway.jsonpath.JsonPath;

public class TestRecordParser extends AbstractTestCase {

	@Ignore
	public void testParser() {
		
		final String path = "$['message']['data']";
		final String EKBE = "{\"magic\": \"atMSG\", \"type\": \"DT\", \"headers\": null, \"messageSchemaId\": null, \"messageSchema\": null, \"message\": {\"data\": {\"MANDT\": \"100\", \"EBELN\": \"4200800592\", \"EBELP\": \"00010\", \"ZEKKN\": \"00\", \"VGABE\": \"8\", \"GJAHR\": \"0000\", \"BELNR\": \"0085423858\", \"BUZEI\": \"0010\", \"BEWTP\": \"L\", \"BWART\": \" \", \"BUDAT\": \"2017-09-17\", \"MENGE\": \"1008.000\", \"BPMNG\": \"0.000\", \"DMBTR\": \"0.00\", \"WRBTR\": \"0.00\", \"WAERS\": \" \", \"AREWR\": \"0.00\", \"WESBS\": \"0.000\", \"BPWES\": \"0.000\", \"SHKZG\": \" \", \"BWTAR\": \" \", \"ELIKZ\": \" \", \"XBLNR\": \" \", \"LFGJA\": \"0000\", \"LFBNR\": \" \", \"LFPOS\": \"0000\", \"GRUND\": \"0000\", \"CPUDT\": \"2017-09-17\", \"CPUTM\": \"06:05:01\", \"REEWR\": \"0.00\", \"EVERE\": \" \", \"REFWR\": \"0.00\", \"MATNR\": \" \", \"WERKS\": \" \", \"XWSBR\": \" \", \"ETENS\": \"0000\", \"KNUMV\": \" \", \"MWSKZ\": \" \", \"LSMNG\": \"0.000\", \"LSMEH\": \" \", \"EMATN\": \" \", \"AREWW\": \"0.00\", \"HSWAE\": \" \", \"BAMNG\": \"0.000\", \"CHARG\": \" \", \"BLDAT\": \"0101-01-01\", \"XWOFF\": \" \", \"XUNPL\": \" \", \"ERNAM\": \" \", \"SRVPOS\": \" \", \"PACKNO\": \"0000000000\", \"INTROW\": \"0000000000\", \"BEKKN\": \"00\", \"LEMIN\": \" \", \"AREWB\": \"0.00\", \"REWRB\": \"0.00\", \"SAPRL\": \" \", \"MENGE_POP\": \"0.000\", \"BPMNG_POP\": \"0.000\", \"DMBTR_POP\": \"0.00\", \"WRBTR_POP\": \"0.00\", \"WESBB\": \"0.000\", \"BPWEB\": \"0.000\", \"WEORA\": \" \", \"AREWR_POP\": \"0.00\", \"KUDIF\": \"0.00\", \"RETAMT_FC\": \"0.00\", \"RETAMT_LC\": \"0.00\", \"RETAMTP_FC\": \"0.00\", \"RETAMTP_LC\": \"0.00\", \"XMACC\": \" \", \"WKURS\": \"0.00000\", \"INV_ITEM_ORIGIN\": \" \", \"VBELN_ST\": \" \", \"VBELP_ST\": \"000000\", \"SGT_SCAT\": \" \", \"ET_UPD\": \" \", \"CWM_BAMNG\": \"0.000\", \"CWM_WESBS\": \"0.000\", \"CWM_TY2TQ\": \" \", \"CWM_WESBB\": \"0.000\", \"J_SC_DIE_COMP_F\": \" \", \"FSH_SEASON_YEAR\": \" \", \"FSH_SEASON\": \" \", \"FSH_COLLECTION\": \" \", \"FSH_THEME\": \" \", \"WRF_CHARSTC1\": \" \", \"WRF_CHARSTC2\": \" \", \"WRF_CHARSTC3\": \" \", \"ATT_Rep_Time\": \"2017-09-19 09:16:05.523000\", \"Table\": \"EKBE\"}, \"beforeData\": {\"MANDT\": \"100\", \"EBELN\": \"4200800592\", \"EBELP\": \"00010\", \"ZEKKN\": \"00\", \"VGABE\": \"8\", \"GJAHR\": \"0000\", \"BELNR\": \"0085423858\", \"BUZEI\": \"0010\", \"BEWTP\": \"L\", \"BWART\": \" \", \"BUDAT\": \"2017-09-17\", \"MENGE\": \"1071.000\", \"BPMNG\": \"0.000\", \"DMBTR\": \"0.00\", \"WRBTR\": \"0.00\", \"WAERS\": \" \", \"AREWR\": \"0.00\", \"WESBS\": \"0.000\", \"BPWES\": \"0.000\", \"SHKZG\": \" \", \"BWTAR\": \" \", \"ELIKZ\": \" \", \"XBLNR\": \" \", \"LFGJA\": \"0000\", \"LFBNR\": \" \", \"LFPOS\": \"0000\", \"GRUND\": \"0000\", \"CPUDT\": \"2017-09-17\", \"CPUTM\": \"06:05:01\", \"REEWR\": \"0.00\", \"EVERE\": \" \", \"REFWR\": \"0.00\", \"MATNR\": \" \", \"WERKS\": \" \", \"XWSBR\": \" \", \"ETENS\": \"0000\", \"KNUMV\": \" \", \"MWSKZ\": \" \", \"LSMNG\": \"0.000\", \"LSMEH\": \" \", \"EMATN\": \" \", \"AREWW\": \"0.00\", \"HSWAE\": \" \", \"BAMNG\": \"0.000\", \"CHARG\": \" \", \"BLDAT\": \"0101-01-01\", \"XWOFF\": \" \", \"XUNPL\": \" \", \"ERNAM\": \" \", \"SRVPOS\": \" \", \"PACKNO\": \"0000000000\", \"INTROW\": \"0000000000\", \"BEKKN\": \"00\", \"LEMIN\": \" \", \"AREWB\": \"0.00\", \"REWRB\": \"0.00\", \"SAPRL\": \" \", \"MENGE_POP\": \"0.000\", \"BPMNG_POP\": \"0.000\", \"DMBTR_POP\": \"0.00\", \"WRBTR_POP\": \"0.00\", \"WESBB\": \"0.000\", \"BPWEB\": \"0.000\", \"WEORA\": \" \", \"AREWR_POP\": \"0.00\", \"KUDIF\": \"0.00\", \"RETAMT_FC\": \"0.00\", \"RETAMT_LC\": \"0.00\", \"RETAMTP_FC\": \"0.00\", \"RETAMTP_LC\": \"0.00\", \"XMACC\": \" \", \"WKURS\": \"0.00000\", \"INV_ITEM_ORIGIN\": \" \", \"VBELN_ST\": \" \", \"VBELP_ST\": \"000000\", \"SGT_SCAT\": \" \", \"ET_UPD\": \" \", \"CWM_BAMNG\": \"0.000\", \"CWM_WESBS\": \"0.000\", \"CWM_TY2TQ\": \" \", \"CWM_WESBB\": \"0.000\", \"J_SC_DIE_COMP_F\": \" \", \"FSH_SEASON_YEAR\": \" \", \"FSH_SEASON\": \" \", \"FSH_COLLECTION\": \" \", \"FSH_THEME\": \" \", \"WRF_CHARSTC1\": \" \", \"WRF_CHARSTC2\": \" \", \"WRF_CHARSTC3\": \" \", \"ATT_Rep_Time\": null, \"Table\": \"EKBE\"}, \"headers\": {\"operation\": \"UPDATE\", \"changeSequence\": \"20170919140345000000000000000003905\", \"timestamp\": \"2017-09-19T14:03:45.000\", \"streamPosition\": \"00000026.d6203ca4.00000001.0004.01.0000:14953.5670931.16\", \"transactionId\": \"00000000000000000000000000210047\"}}}";
		
		DocumentContext jsonContext = JsonPath.parse(EKBE);
		Map<String, Object> doc = jsonContext.read(path);
		
		for (String key : doc.keySet()) {
			System.out.println(key + " " + doc.get(key));
		}
		
	}
	
	@Test
	public void generateOutputFieldsByRecordType() {
		
		final String path = "$['message']['data']";
		ArrayList<String> samples = new ArrayList<String>();
		samples.add("{\"magic\": \"atMSG\", \"type\": \"DT\", \"headers\": null, \"messageSchemaId\": null, \"messageSchema\": null, \"message\": {\"data\": {\"MANDT\": \"100\", \"EBELN\": \"4200800592\", \"EBELP\": \"00010\", \"ZEKKN\": \"00\", \"VGABE\": \"8\", \"GJAHR\": \"0000\", \"BELNR\": \"0085423858\", \"BUZEI\": \"0010\", \"BEWTP\": \"L\", \"BWART\": \" \", \"BUDAT\": \"2017-09-17\", \"MENGE\": \"1008.000\", \"BPMNG\": \"0.000\", \"DMBTR\": \"0.00\", \"WRBTR\": \"0.00\", \"WAERS\": \" \", \"AREWR\": \"0.00\", \"WESBS\": \"0.000\", \"BPWES\": \"0.000\", \"SHKZG\": \" \", \"BWTAR\": \" \", \"ELIKZ\": \" \", \"XBLNR\": \" \", \"LFGJA\": \"0000\", \"LFBNR\": \" \", \"LFPOS\": \"0000\", \"GRUND\": \"0000\", \"CPUDT\": \"2017-09-17\", \"CPUTM\": \"06:05:01\", \"REEWR\": \"0.00\", \"EVERE\": \" \", \"REFWR\": \"0.00\", \"MATNR\": \" \", \"WERKS\": \" \", \"XWSBR\": \" \", \"ETENS\": \"0000\", \"KNUMV\": \" \", \"MWSKZ\": \" \", \"LSMNG\": \"0.000\", \"LSMEH\": \" \", \"EMATN\": \" \", \"AREWW\": \"0.00\", \"HSWAE\": \" \", \"BAMNG\": \"0.000\", \"CHARG\": \" \", \"BLDAT\": \"0101-01-01\", \"XWOFF\": \" \", \"XUNPL\": \" \", \"ERNAM\": \" \", \"SRVPOS\": \" \", \"PACKNO\": \"0000000000\", \"INTROW\": \"0000000000\", \"BEKKN\": \"00\", \"LEMIN\": \" \", \"AREWB\": \"0.00\", \"REWRB\": \"0.00\", \"SAPRL\": \" \", \"MENGE_POP\": \"0.000\", \"BPMNG_POP\": \"0.000\", \"DMBTR_POP\": \"0.00\", \"WRBTR_POP\": \"0.00\", \"WESBB\": \"0.000\", \"BPWEB\": \"0.000\", \"WEORA\": \" \", \"AREWR_POP\": \"0.00\", \"KUDIF\": \"0.00\", \"RETAMT_FC\": \"0.00\", \"RETAMT_LC\": \"0.00\", \"RETAMTP_FC\": \"0.00\", \"RETAMTP_LC\": \"0.00\", \"XMACC\": \" \", \"WKURS\": \"0.00000\", \"INV_ITEM_ORIGIN\": \" \", \"VBELN_ST\": \" \", \"VBELP_ST\": \"000000\", \"SGT_SCAT\": \" \", \"ET_UPD\": \" \", \"CWM_BAMNG\": \"0.000\", \"CWM_WESBS\": \"0.000\", \"CWM_TY2TQ\": \" \", \"CWM_WESBB\": \"0.000\", \"J_SC_DIE_COMP_F\": \" \", \"FSH_SEASON_YEAR\": \" \", \"FSH_SEASON\": \" \", \"FSH_COLLECTION\": \" \", \"FSH_THEME\": \" \", \"WRF_CHARSTC1\": \" \", \"WRF_CHARSTC2\": \" \", \"WRF_CHARSTC3\": \" \", \"ATT_Rep_Time\": \"2017-09-19 09:16:05.523000\", \"Table\": \"EKBE\"}, \"beforeData\": {\"MANDT\": \"100\", \"EBELN\": \"4200800592\", \"EBELP\": \"00010\", \"ZEKKN\": \"00\", \"VGABE\": \"8\", \"GJAHR\": \"0000\", \"BELNR\": \"0085423858\", \"BUZEI\": \"0010\", \"BEWTP\": \"L\", \"BWART\": \" \", \"BUDAT\": \"2017-09-17\", \"MENGE\": \"1071.000\", \"BPMNG\": \"0.000\", \"DMBTR\": \"0.00\", \"WRBTR\": \"0.00\", \"WAERS\": \" \", \"AREWR\": \"0.00\", \"WESBS\": \"0.000\", \"BPWES\": \"0.000\", \"SHKZG\": \" \", \"BWTAR\": \" \", \"ELIKZ\": \" \", \"XBLNR\": \" \", \"LFGJA\": \"0000\", \"LFBNR\": \" \", \"LFPOS\": \"0000\", \"GRUND\": \"0000\", \"CPUDT\": \"2017-09-17\", \"CPUTM\": \"06:05:01\", \"REEWR\": \"0.00\", \"EVERE\": \" \", \"REFWR\": \"0.00\", \"MATNR\": \" \", \"WERKS\": \" \", \"XWSBR\": \" \", \"ETENS\": \"0000\", \"KNUMV\": \" \", \"MWSKZ\": \" \", \"LSMNG\": \"0.000\", \"LSMEH\": \" \", \"EMATN\": \" \", \"AREWW\": \"0.00\", \"HSWAE\": \" \", \"BAMNG\": \"0.000\", \"CHARG\": \" \", \"BLDAT\": \"0101-01-01\", \"XWOFF\": \" \", \"XUNPL\": \" \", \"ERNAM\": \" \", \"SRVPOS\": \" \", \"PACKNO\": \"0000000000\", \"INTROW\": \"0000000000\", \"BEKKN\": \"00\", \"LEMIN\": \" \", \"AREWB\": \"0.00\", \"REWRB\": \"0.00\", \"SAPRL\": \" \", \"MENGE_POP\": \"0.000\", \"BPMNG_POP\": \"0.000\", \"DMBTR_POP\": \"0.00\", \"WRBTR_POP\": \"0.00\", \"WESBB\": \"0.000\", \"BPWEB\": \"0.000\", \"WEORA\": \" \", \"AREWR_POP\": \"0.00\", \"KUDIF\": \"0.00\", \"RETAMT_FC\": \"0.00\", \"RETAMT_LC\": \"0.00\", \"RETAMTP_FC\": \"0.00\", \"RETAMTP_LC\": \"0.00\", \"XMACC\": \" \", \"WKURS\": \"0.00000\", \"INV_ITEM_ORIGIN\": \" \", \"VBELN_ST\": \" \", \"VBELP_ST\": \"000000\", \"SGT_SCAT\": \" \", \"ET_UPD\": \" \", \"CWM_BAMNG\": \"0.000\", \"CWM_WESBS\": \"0.000\", \"CWM_TY2TQ\": \" \", \"CWM_WESBB\": \"0.000\", \"J_SC_DIE_COMP_F\": \" \", \"FSH_SEASON_YEAR\": \" \", \"FSH_SEASON\": \" \", \"FSH_COLLECTION\": \" \", \"FSH_THEME\": \" \", \"WRF_CHARSTC1\": \" \", \"WRF_CHARSTC2\": \" \", \"WRF_CHARSTC3\": \" \", \"ATT_Rep_Time\": null, \"Table\": \"EKBE\"}, \"headers\": {\"operation\": \"UPDATE\", \"changeSequence\": \"20170919140345000000000000000003905\", \"timestamp\": \"2017-09-19T14:03:45.000\", \"streamPosition\": \"00000026.d6203ca4.00000001.0004.01.0000:14953.5670931.16\", \"transactionId\": \"00000000000000000000000000210047\"}}}");
		samples.add("{\"magic\": \"atMSG\", \"type\": \"DT\", \"headers\": null, \"messageSchemaId\": null, \"messageSchema\": null, \"message\": {\"data\": {\"MANDT\": \"100\", \"EBELN\": \"4200800592\", \"EBELP\": \"00010\", \"ETENR\": \"0001\", \"EINDT\": \"2017-09-18\", \"SLFDT\": \"2017-09-18\", \"LPEIN\": \"1\", \"MENGE\": \"1071.000\", \"AMENG\": \"0.000\", \"WEMNG\": \"0.000\", \"WAMNG\": \"0.000\", \"UZEIT\": \"10:12:00\", \"BANFN\": \" \", \"BNFPO\": \"00000\", \"ESTKZ\": \"R\", \"QUNUM\": \" \", \"QUPOS\": \"000\", \"MAHNZ\": \"0\", \"BEDAT\": \"2017-09-17\", \"RSNUM\": \"0000000000\", \"SERNR\": \" \", \"FIXKZ\": \"X\", \"GLMNG\": \"1008.000\", \"DABMG\": \"0.000\", \"CHARG\": \" \", \"LICHA\": \" \", \"CHKOM\": \" \", \"VERID\": \" \", \"ABART\": \" \", \"MNG02\": \"0.000\", \"DAT01\": \"9999-12-31\", \"ALTDT\": \"0101-01-01\", \"AULWE\": \" \", \"MBDAT\": \"2017-09-18\", \"MBUHR\": \"07:00:00\", \"LDDAT\": \"2017-09-18\", \"LDUHR\": \"07:00:00\", \"TDDAT\": \"2017-09-18\", \"TDUHR\": \"00:00:00\", \"WADAT\": \"2017-09-18\", \"WAUHR\": \"07:00:00\", \"ELDAT\": \"2017-09-18\", \"ELUHR\": \"10:12:00\", \"ANZSN\": 0, \"NODISP\": \" \", \"GEO_ROUTE\": \" \", \"ROUTE_GTS\": \" \", \"GTS_IND\": \" \", \"TSP\": \" \", \"CD_LOCNO\": \" \", \"CD_LOCTYPE\": \" \", \"HANDOVERDATE\": \"0101-01-01\", \"HANDOVERTIME\": \"00:00:00\", \"CWM_MENGE\": \"0.000\", \"CWM_DABMG\": \"0.000\", \"CWM_WEMNG\": \"0.000\", \"SPMEAT_SPANR\": \"000000000000\", \"SPMEAT_SPSNR\": \"000000000000\", \"FSH_RALLOC_QTY\": \"0.000\", \"FSH_SALLOC_QTY\": \"0.000\", \"FSH_OS_ID\": \"0000\", \"KEY_ID\": \"0000000000000000\", \"OTB_VALUE\": \"0.00\", \"OTB_CURR\": \" \", \"OTB_RES_VALUE\": \"0.00\", \"OTB_SPEC_VALUE\": \"0.00\", \"SPR_RSN_PROFILE\": \" \", \"BUDG_TYPE\": \" \", \"OTB_STATUS\": \" \", \"OTB_REASON\": \" \", \"CHECK_TYPE\": \" \", \"DL_ID\": \" \", \"HANDOVER_DATE\": \"0101-01-01\", \"NO_SCEM\": \" \", \"DNG_DATE\": \"0101-01-01\", \"DNG_TIME\": \"00:00:00\", \"CNCL_ANCMNT_DONE\": \" \", \"DATESHIFT_NUMBER\": \"0\", \"ATT_Rep_Time\": \"2017-09-19 09:16:05.523000\", \"Table\": \"EKET\"}, \"beforeData\": {\"MANDT\": \"100\", \"EBELN\": \"4200800592\", \"EBELP\": \"00010\", \"ETENR\": \"0001\", \"EINDT\": \"2017-09-18\", \"SLFDT\": \"2017-09-18\", \"LPEIN\": \"1\", \"MENGE\": \"1071.000\", \"AMENG\": \"0.000\", \"WEMNG\": \"0.000\", \"WAMNG\": \"0.000\", \"UZEIT\": \"10:12:00\", \"BANFN\": \" \", \"BNFPO\": \"00000\", \"ESTKZ\": \"R\", \"QUNUM\": \" \", \"QUPOS\": \"000\", \"MAHNZ\": \"0\", \"BEDAT\": \"2017-09-17\", \"RSNUM\": \"0000000000\", \"SERNR\": \" \", \"FIXKZ\": \"X\", \"GLMNG\": \"1071.000\", \"DABMG\": \"0.000\", \"CHARG\": \" \", \"LICHA\": \" \", \"CHKOM\": \" \", \"VERID\": \" \", \"ABART\": \" \", \"MNG02\": \"0.000\", \"DAT01\": \"9999-12-31\", \"ALTDT\": \"0101-01-01\", \"AULWE\": \" \", \"MBDAT\": \"2017-09-18\", \"MBUHR\": \"07:00:00\", \"LDDAT\": \"2017-09-18\", \"LDUHR\": \"07:00:00\", \"TDDAT\": \"2017-09-18\", \"TDUHR\": \"00:00:00\", \"WADAT\": \"2017-09-18\", \"WAUHR\": \"07:00:00\", \"ELDAT\": \"2017-09-18\", \"ELUHR\": \"10:12:00\", \"ANZSN\": 0, \"NODISP\": \" \", \"GEO_ROUTE\": \" \", \"ROUTE_GTS\": \" \", \"GTS_IND\": \" \", \"TSP\": \" \", \"CD_LOCNO\": \" \", \"CD_LOCTYPE\": \" \", \"HANDOVERDATE\": \"0101-01-01\", \"HANDOVERTIME\": \"00:00:00\", \"CWM_MENGE\": \"0.000\", \"CWM_DABMG\": \"0.000\", \"CWM_WEMNG\": \"0.000\", \"SPMEAT_SPANR\": \"000000000000\", \"SPMEAT_SPSNR\": \"000000000000\", \"FSH_RALLOC_QTY\": \"0.000\", \"FSH_SALLOC_QTY\": \"0.000\", \"FSH_OS_ID\": \"0000\", \"KEY_ID\": \"0000000000000000\", \"OTB_VALUE\": \"0.00\", \"OTB_CURR\": \" \", \"OTB_RES_VALUE\": \"0.00\", \"OTB_SPEC_VALUE\": \"0.00\", \"SPR_RSN_PROFILE\": \" \", \"BUDG_TYPE\": \" \", \"OTB_STATUS\": \" \", \"OTB_REASON\": \" \", \"CHECK_TYPE\": \" \", \"DL_ID\": \" \", \"HANDOVER_DATE\": \"0101-01-01\", \"NO_SCEM\": \" \", \"DNG_DATE\": \"0101-01-01\", \"DNG_TIME\": \"00:00:00\", \"CNCL_ANCMNT_DONE\": \" \", \"DATESHIFT_NUMBER\": \"0\", \"ATT_Rep_Time\": null, \"Table\": \"EKET\"}, \"headers\": {\"operation\": \"UPDATE\", \"changeSequence\": \"20170919140345000000000000000003917\", \"timestamp\": \"2017-09-19T14:03:45.000\", \"streamPosition\": \"00000026.d6203ca5.00000001.000a.01.0000:14953.5670931.16\", \"transactionId\": \"00000000000000000000000000210047\"}}}");
		samples.add("{\"magic\": \"atMSG\", \"type\": \"DT\", \"headers\": null, \"messageSchemaId\": null, \"messageSchema\": null, \"message\": {\"data\": {\"MANDT\": \"100\", \"EBELN\": \"3600020864\", \"BUKRS\": \"0001\", \"BSTYP\": \"F\", \"BSART\": \"NB\", \"BSAKZ\": \" \", \"LOEKZ\": \" \", \"STATU\": \"9\", \"AEDAT\": \"2017-09-19\", \"ERNAM\": \"NEILLJ\", \"PINCR\": \"00010\", \"LPONR\": \"00010\", \"LIFNR\": \"0000347491\", \"SPRAS\": \"E\", \"ZTERM\": \"YE19\", \"ZBD1T\": \"18\", \"ZBD2T\": \"0\", \"ZBD3T\": \"0\", \"ZBD1P\": \"0.000\", \"ZBD2P\": \"0.000\", \"EKORG\": \"TYSN\", \"EKGRP\": \"360\", \"WAERS\": \"USD\", \"WKURS\": \"1.00000\", \"KUFIX\": \" \", \"BEDAT\": \"2017-09-19\", \"KDATB\": \"0101-01-01\", \"KDATE\": \"0101-01-01\", \"BWBDT\": \"0101-01-01\", \"ANGDT\": \"0101-01-01\", \"BNDDT\": \"0101-01-01\", \"GWLDT\": \"0101-01-01\", \"AUSNR\": \" \", \"ANGNR\": \" \", \"IHRAN\": \"0101-01-01\", \"IHREZ\": \" \", \"VERKF\": \" \", \"TELF1\": \" \", \"LLIEF\": \" \", \"KUNNR\": \" \", \"KONNR\": \" \", \"ABGRU\": \" \", \"AUTLF\": \" \", \"WEAKT\": \" \", \"RESWK\": \" \", \"LBLIF\": \" \", \"INCO1\": \" \", \"INCO2\": \" \", \"KTWRT\": \"0.00\", \"SUBMI\": \" \", \"KNUMV\": \"1010304983\", \"KALSM\": \"RM0000\", \"STAFO\": \"SAP\", \"LIFRE\": \"0000347491\", \"EXNUM\": \" \", \"UNSEZ\": \" \", \"LOGSY\": \" \", \"UPINC\": \"00001\", \"STAKO\": \" \", \"FRGGR\": \" \", \"FRGSX\": \" \", \"FRGKE\": \" \", \"FRGZU\": \" \", \"FRGRL\": \" \", \"LANDS\": \"US\", \"LPHIS\": \" \", \"ADRNR\": \" \", \"STCEG_L\": \"US\", \"STCEG\": \" \", \"ABSGR\": \"00\", \"ADDNR\": \" \", \"KORNR\": \" \", \"MEMORY\": \" \", \"PROCSTAT\": \"02\", \"RLWRT\": \"0.00\", \"REVNO\": \" \", \"SCMPROC\": \" \", \"REASON_CODE\": \" \", \"MEMORYTYPE\": \" \", \"RETTP\": \" \", \"RETPC\": \"0.00\", \"DPTYP\": \" \", \"DPPCT\": \"0.00\", \"DPAMT\": \"0.00\", \"DPDAT\": \"0101-01-01\", \"MSR_ID\": \" \", \"HIERARCHY_EXISTS\": \" \", \"THRESHOLD_EXISTS\": \" \", \"LEGAL_CONTRACT\": \" \", \"DESCRIPTION\": \" \", \"RELEASE_DATE\": \"0101-01-01\", \"VSART\": \" \", \"HANDOVERLOC\": \" \", \"SHIPCOND\": \" \", \"INCOV\": \" \", \"INCO2_L\": \" \", \"INCO3_L\": \" \", \"FORCE_ID\": \" \", \"FORCE_CNT\": \"000000\", \"RELOC_ID\": \" \", \"RELOC_SEQ_ID\": \" \", \"SOURCE_LOGSYS\": \" \", \"FSH_TRANSACTION\": \" \", \"FSH_ITEM_GROUP\": \"00000\", \"FSH_VAS_LAST_ITEM\": \"00000\", \"FSH_OS_STG_CHANGE\": \" \", \"VZSKZ\": \" \", \"FSH_SNST_STATUS\": \" \", \"POHF_TYPE\": \" \", \"EQ_EINDT\": \"0101-01-01\", \"EQ_WERKS\": \" \", \"FIXPO\": \" \", \"EKGRP_ALLOW\": \" \", \"WERKS_ALLOW\": \" \", \"CONTRACT_ALLOW\": \" \", \"PSTYP_ALLOW\": \" \", \"FIXPO_ALLOW\": \" \", \"KEY_ID_ALLOW\": \" \", \"AUREL_ALLOW\": \" \", \"DELPER_ALLOW\": \" \", \"EINDT_ALLOW\": \" \", \"LTSNR_ALLOW\": \" \", \"OTB_LEVEL\": \" \", \"OTB_COND_TYPE\": \" \", \"KEY_ID\": \"0000000000000000\", \"OTB_VALUE\": \"0.00\", \"OTB_CURR\": \" \", \"OTB_RES_VALUE\": \"0.00\", \"OTB_SPEC_VALUE\": \"0.00\", \"SPR_RSN_PROFILE\": \" \", \"BUDG_TYPE\": \" \", \"OTB_STATUS\": \" \", \"OTB_REASON\": \" \", \"CHECK_TYPE\": \" \", \"CON_OTB_REQ\": \" \", \"CON_PREBOOK_LEV\": \" \", \"CON_DISTR_LEV\": \" \", \"ATT_Rep_Time\": \"2017-09-19 09:16:05.634000\", \"Table\": \"EKKO\"}, \"beforeData\": null, \"headers\": {\"operation\": \"INSERT\", \"changeSequence\": \"20170919140345000000000000000003929\", \"timestamp\": \"2017-09-19T14:03:45.000\", \"streamPosition\": \"00000026.d6203748.00000001.0001.01.0000:14953.5661032.16\", \"transactionId\": \"00000000000000000000000000110003\"}}}");
		samples.add("{\"magic\": \"atMSG\", \"type\": \"DT\", \"headers\": null, \"messageSchemaId\": null, \"messageSchema\": null, \"message\": {\"data\": {\"MANDT\": \"100\", \"EBELN\": \"3600020864\", \"EBELP\": \"00010\", \"LOEKZ\": \" \", \"STATU\": \" \", \"AEDAT\": \"2017-09-19\", \"TXZ01\": \"CKN BST SHEL W/ SKN\", \"MATNR\": \"009864-1000\", \"EMATN\": \"009864-1000\", \"BUKRS\": \"0001\", \"WERKS\": \"1467\", \"LGORT\": \"0401\", \"BEDNR\": \" \", \"MATKL\": \"10005769\", \"INFNR\": \"5300627943\", \"IDNLF\": \" \", \"KTMNG\": \"0.000\", \"MENGE\": \"40000.000\", \"MEINS\": \"LB\", \"BPRME\": \"LB\", \"BPUMZ\": \"1\", \"BPUMN\": \"1\", \"UMREZ\": \"1\", \"UMREN\": \"1700\", \"NETPR\": \"8.75\", \"PEINH\": \"100\", \"NETWR\": \"3500.00\", \"BRTWR\": \"3500.00\", \"AGDAT\": \"0101-01-01\", \"WEBAZ\": \"0\", \"MWSKZ\": \"I0\", \"BONUS\": \" \", \"INSMK\": \" \", \"SPINF\": \"B\", \"PRSDR\": \"X\", \"SCHPR\": \" \", \"MAHNZ\": \"0\", \"MAHN1\": \"0\", \"MAHN2\": \"0\", \"MAHN3\": \"0\", \"UEBTO\": \"90.0\", \"UEBTK\": \" \", \"UNTTO\": \"90.0\", \"BWTAR\": \" \", \"BWTTY\": \" \", \"ABSKZ\": \" \", \"AGMEM\": \" \", \"ELIKZ\": \" \", \"EREKZ\": \" \", \"PSTYP\": \"0\", \"KNTTP\": \" \", \"KZVBR\": \" \", \"VRTKZ\": \" \", \"TWRKZ\": \" \", \"WEPOS\": \"X\", \"WEUNB\": \" \", \"REPOS\": \"X\", \"WEBRE\": \" \", \"KZABS\": \"X\", \"LABNR\": \" \", \"KONNR\": \" \", \"KTPNR\": \"00000\", \"ABDAT\": \"0101-01-01\", \"ABFTZ\": \"0.000\", \"ETFZ1\": \"0\", \"ETFZ2\": \"0\", \"KZSTU\": \" \", \"NOTKZ\": \" \", \"LMEIN\": \"CS\", \"EVERS\": \" \", \"ZWERT\": \"0.00\", \"NAVNW\": \"0.00\", \"ABMNG\": \"0.000\", \"PRDAT\": \"2017-09-19\", \"BSTYP\": \"F\", \"EFFWR\": \"4500.00\", \"XOBLR\": \" \", \"KUNNR\": \" \", \"ADRNR\": \" \", \"EKKOL\": \" \", \"SKTOF\": \" \", \"STAFO\": \"SAP\", \"PLIFZ\": \"0\", \"NTGEW\": \"1.000\", \"GEWEI\": \"LB\", \"TXJCD\": \"1111720870\", \"ETDRK\": \" \", \"SOBKZ\": \" \", \"ARSNR\": \"0000000000\", \"ARSPS\": \"0000\", \"INSNC\": \" \", \"SSQSS\": \" \", \"ZGTYP\": \" \", \"EAN11\": \" \", \"BSTAE\": \"Z006\", \"REVLV\": \" \", \"GEBER\": \" \", \"FISTL\": \" \", \"FIPOS\": \" \", \"KO_GSBER\": \" \", \"KO_PARGB\": \" \", \"KO_PRCTR\": \"0880217014\", \"KO_PPRCTR\": \" \", \"MEPRF\": \" \", \"BRGEW\": \"1.013\", \"VOLUM\": \"0.037\", \"VOLEH\": \"FT3\", \"INCO1\": \" \", \"INCO2\": \" \", \"VORAB\": \" \", \"KOLIF\": \" \", \"LTSNR\": \" \", \"PACKNO\": \"0000000000\", \"FPLNR\": \" \", \"GNETWR\": \"0.00\", \"STAPO\": \" \", \"UEBPO\": \"00000\", \"LEWED\": \"0101-01-01\", \"EMLIF\": \" \", \"LBLKZ\": \" \", \"SATNR\": \" \", \"ATTYP\": \" \", \"VSART\": \" \", \"HANDOVERLOC\": \" \", \"KANBA\": \" \", \"ADRN2\": \" \", \"CUOBJ\": \"000000000000000000\", \"XERSY\": \" \", \"EILDT\": \"0101-01-01\", \"DRDAT\": \"0101-01-01\", \"DRUHR\": \"00:00:00\", \"DRUNR\": \"0001\", \"AKTNR\": \" \", \"ABELN\": \" \", \"ABELP\": \"00000\", \"ANZPU\": \"0.000\", \"PUNEI\": \" \", \"SAISO\": \" \", \"SAISJ\": \" \", \"EBON2\": \" \", \"EBON3\": \" \", \"EBONF\": \" \", \"MLMAA\": \" \", \"MHDRZ\": \"1\", \"ANFNR\": \" \", \"ANFPS\": \"00000\", \"KZKFG\": \" \", \"USEQU\": \" \", \"UMSOK\": \" \", \"BANFN\": \" \", \"BNFPO\": \"00000\", \"MTART\": \"ZFGI\", \"UPTYP\": \" \", \"UPVOR\": \" \", \"KZWI1\": \"0.00\", \"KZWI2\": \"0.00\", \"KZWI3\": \"0.00\", \"KZWI4\": \"0.00\", \"KZWI5\": \"0.00\", \"KZWI6\": \"0.00\", \"SIKGR\": \" \", \"MFZHI\": \"0.000\", \"FFZHI\": \"0.000\", \"RETPO\": \" \", \"AUREL\": \" \", \"BSGRU\": \" \", \"LFRET\": \" \", \"MFRGR\": \" \", \"NRFHG\": \" \", \"J_1BNBM\": \" \", \"J_1BMATUSE\": \" \", \"J_1BMATORG\": \" \", \"J_1BOWNPRO\": \" \", \"J_1BINDUST\": \" \", \"ABUEB\": \" \", \"NLABD\": \"0101-01-01\", \"NFABD\": \"0101-01-01\", \"KZBWS\": \" \", \"BONBA\": \"3500.00\", \"FABKZ\": \" \", \"J_1AINDXP\": \" \", \"J_1AIDATEP\": \"0101-01-01\", \"MPROF\": \" \", \"EGLKZ\": \" \", \"KZTLF\": \" \", \"KZFME\": \"B\", \"RDPRF\": \" \", \"TECHS\": \" \", \"CHG_SRV\": \" \", \"CHG_FPLNR\": \" \", \"MFRPN\": \" \", \"MFRNR\": \" \", \"EMNFR\": \" \", \"NOVET\": \" \", \"AFNAM\": \" \", \"TZONRC\": \"EST\", \"IPRKZ\": \" \", \"LEBRE\": \" \", \"BERID\": \"1467\", \"XCONDITIONS\": \" \", \"APOMS\": \" \", \"CCOMP\": \" \", \"GRANT_NBR\": \" \", \"FKBER\": \" \", \"STATUS\": \" \", \"RESLO\": \" \", \"KBLNR\": \" \", \"KBLPOS\": \"000\", \"WEORA\": \" \", \"SRV_BAS_COM\": \" \", \"PRIO_URG\": \"00\", \"PRIO_REQ\": \"000\", \"EMPST\": \" \", \"DIFF_INVOICE\": \" \", \"TRMRISK_RELEVANT\": \" \", \"SPE_ABGRU\": \" \", \"SPE_CRM_SO\": \" \", \"SPE_CRM_SO_ITEM\": \"000000\", \"SPE_CRM_REF_SO\": \" \", \"SPE_CRM_REF_ITEM\": \" \", \"SPE_CRM_FKREL\": \" \", \"SPE_CHNG_SYS\": \" \", \"SPE_INSMK_SRC\": \" \", \"SPE_CQ_CTRLTYPE\": \" \", \"SPE_CQ_NOCQ\": \" \", \"REASON_CODE\": \" \", \"CQU_SAR\": \"0.000\", \"ANZSN\": 0, \"SPE_EWM_DTC\": \" \", \"EXLIN\": \" \", \"EXSNR\": \"00000\", \"EHTYP\": \" \", \"RETPC\": \"0.00\", \"DPTYP\": \" \", \"DPPCT\": \"0.00\", \"DPAMT\": \"0.00\", \"DPDAT\": \"0101-01-01\", \"FLS_RSTO\": \" \", \"EXT_RFX_NUMBER\": \" \", \"EXT_RFX_ITEM\": \" \", \"EXT_RFX_SYSTEM\": \" \", \"SRM_CONTRACT_ID\": \" \", \"SRM_CONTRACT_ITM\": \"0000000000\", \"BLK_REASON_ID\": \" \", \"BLK_REASON_TXT\": \" \", \"ITCONS\": \" \", \"FIXMG\": \" \", \"WABWE\": \" \", \"CMPL_DLV_ITM\": \" \", \"INCO2_L\": \" \", \"INCO3_L\": \" \", \"TC_AUT_DET\": \" \", \"MANUAL_TC_REASON\": \" \", \"FISCAL_INCENTIVE\": \" \", \"TAX_SUBJECT_ST\": \" \", \"FISCAL_INCENTIVE_ID\": \" \", \"SF_TXJCD\": \" \", \"BEV1_NEGEN_ITEM\": \" \", \"BEV1_NEDEPFREE\": \" \", \"BEV1_NESTRUCCAT\": \" \", \"CWM_WABWE\": \" \", \"ADVCODE\": \" \", \"BUDGET_PD\": \" \", \"EXCPE\": \"00\", \"FMFGUS_KEY\": \" \", \"IUID_RELEVANT\": \" \", \"MRPIND\": \" \", \"SGT_SCAT\": \" \", \"SGT_RCAT\": \" \", \"WRF_CHARSTC1\": \" \", \"WRF_CHARSTC2\": \" \", \"WRF_CHARSTC3\": \" \", \"REFSITE\": \" \", \"SPMEAT_SLPNR\": \" \", \"SPMEAT_SLDAT\": \"0101-01-01\", \"SPMEAT_EXTNR\": \" \", \"SPMEAT_LVANR\": \" \", \"SPMEAT_POSTN\": \"000000\", \"SPMEAT_TQTYP\": \" \", \"SPMEAT_TQUAL\": \"000\", \"SERRU\": \" \", \"SERNP\": \" \", \"DISUB_SOBKZ\": \" \", \"DISUB_PSPNR\": \"00000000\", \"DISUB_KUNNR\": \" \", \"DISUB_VBELN\": \" \", \"DISUB_POSNR\": \"000000\", \"DISUB_OWNER\": \" \", \"FSH_SEASON_YEAR\": \" \", \"FSH_SEASON\": \" \", \"FSH_COLLECTION\": \" \", \"FSH_THEME\": \" \", \"FSH_ATP_DATE\": \"0101-01-01\", \"FSH_VAS_REL\": \" \", \"FSH_VAS_PRNT_ID\": \"00000\", \"FSH_TRANSACTION\": \" \", \"FSH_ITEM_GROUP\": \"00000\", \"FSH_ITEM\": \"00000\", \"FSH_SS\": \" \", \"FSH_GRID_COND_REC\": \" \", \"FSH_PSM_PFM_SPLIT\": \" \", \"CNFM_QTY\": \"0.000\", \"REF_ITEM\": \"00000\", \"SOURCE_ID\": \" \", \"SOURCE_KEY\": \" \", \"PUT_BACK\": \" \", \"POL_ID\": \" \", \"CONS_ORDER\": \" \", \"ATT_Rep_Time\": \"2017-09-19 09:16:05.635000\", \"Table\": \"EKPO\"}, \"beforeData\": null, \"headers\": {\"operation\": \"INSERT\", \"changeSequence\": \"20170919140345000000000000000003937\", \"timestamp\": \"2017-09-19T14:03:45.000\", \"streamPosition\": \"00000026.d6203757.00000001.000a.01.0000:14953.5661032.16\", \"transactionId\": \"00000000000000000000000000110003\"}}}");
		
		for (String sample : samples) {
			DocumentContext jsonContext = JsonPath.parse(sample);
			Map<String, Object> doc = jsonContext.read(path);
			
			StringBuffer buf = new StringBuffer();
			buf.append(doc.get("Table") + ": ");
			for(String key : doc.keySet())
				buf.append(key + ",");
			
			System.out.println(buf.toString());
		}
	
	}

}
